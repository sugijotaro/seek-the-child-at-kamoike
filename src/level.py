import pyxel
from vec2 import Vec2


class Level:
    HOME_START_POS = Vec2(32, 32)
    HOME_END_POS = Vec2(52, 52)
    UNDERWATER_AREAS = [
        (190, 26, 198, 26),
        (185, 27, 201, 27),
        (183, 28, 204, 28),
        (180, 29, 205, 29),
        (178, 30, 207, 30),
        (177, 31, 208, 31),
        (175, 32, 209, 32),
        (174, 33, 210, 33),
        (172, 34, 211, 34),
        (171, 35, 212, 35),
        (170, 36, 212, 36),
        (169, 37, 213, 37),
        (168, 38, 214, 38),
        (166, 39, 214, 39),
        (165, 40, 215, 40),
        (164, 41, 215, 41),
        (163, 42, 216, 42),
        (163, 43, 216, 43),
        (162, 44, 217, 44),
        (161, 45, 217, 45),
        (160, 46, 218, 46),
        (159, 47, 218, 47),
        (158, 48, 219, 48),
        (157, 49, 219, 49),
        (156, 50, 220, 50),
        (155, 51, 220, 51),
        (155, 52, 220, 52),
        (154, 53, 221, 53),
        (153, 54, 221, 54),
        (152, 55, 221, 55),
        (151, 56, 222, 56),
        (150, 57, 222, 57),
        (149, 58, 222, 58),
        (148, 59, 223, 59),
        (147, 60, 223, 60),
        (146, 61, 223, 61),
        (145, 62, 223, 62),
        (144, 63, 224, 63),
        (143, 64, 224, 64),
        (143, 65, 224, 65),
        (141, 66, 224, 66),
        (140, 67, 225, 67),
        (139, 68, 225, 68),
        (138, 69, 225, 69),
        (137, 70, 225, 70),
        (136, 71, 225, 71),
        (135, 72, 225, 72),
        (133, 73, 225, 73),
        (132, 74, 225, 74),
        (131, 75, 226, 75),
        (130, 76, 226, 76),
        (128, 77, 226, 77),
        (127, 78, 226, 78),
        (125, 79, 226, 79),
        (124, 80, 226, 80),
        (122, 81, 226, 81),
        (120, 82, 226, 82),
        (118, 83, 226, 83),
        (116, 84, 226, 84),
        (114, 85, 226, 85),
        (111, 86, 226, 86),
        (108, 87, 226, 87),
        (104, 88, 226, 88),
        (100, 89, 226, 89),
        (38, 90, 73, 90),
        (92, 90, 225, 90),
        (35, 91, 225, 91),
        (34, 92, 225, 92),
        (33, 93, 225, 93),
        (33, 94, 225, 94),
        (32, 95, 225, 95),
        (32, 96, 225, 96),
        (31, 97, 224, 97),
        (31, 98, 224, 98),
        (31, 99, 224, 99),
        (31, 100, 224, 100),
        (31, 101, 224, 101),
        (31, 102, 223, 102),
        (32, 103, 223, 103),
        (32, 104, 223, 104),
        (32, 105, 222, 105),
        (32, 106, 222, 106),
        (32, 107, 222, 107),
        (33, 108, 222, 108),
        (33, 109, 221, 109),
        (33, 110, 221, 110),
        (33, 111, 220, 111),
        (34, 112, 220, 112),
        (34, 113, 220, 113),
        (34, 114, 219, 114),
        (35, 115, 219, 115),
        (35, 116, 218, 116),
        (35, 117, 218, 117),
        (36, 118, 217, 118),
        (36, 119, 217, 119),
        (37, 120, 216, 120),
        (37, 121, 216, 121),
        (38, 122, 215, 122),
        (38, 123, 214, 123),
        (39, 124, 214, 124),
        (39, 125, 213, 125),
        (40, 126, 212, 126),
        (40, 127, 105, 127),
        (125, 127, 212, 127),
        (41, 128, 100, 128),
        (130, 128, 211, 128),
        (41, 129, 96, 129),
        (133, 129, 210, 129),
        (42, 130, 93, 130),
        (136, 130, 209, 130),
        (43, 131, 90, 131),
        (138, 131, 209, 131),
        (43, 132, 88, 132),
        (140, 132, 208, 132),
        (44, 133, 85, 133),
        (142, 133, 207, 133),
        (44, 134, 83, 134),
        (144, 134, 206, 134),
        (45, 135, 81, 135),
        (146, 135, 205, 135),
        (47, 136, 79, 136),
        (147, 136, 204, 136),
        (48, 137, 78, 137),
        (149, 137, 203, 137),
        (49, 138, 76, 138),
        (151, 138, 202, 138),
        (51, 139, 74, 139),
        (152, 139, 201, 139),
        (52, 140, 73, 140),
        (154, 140, 199, 140),
        (54, 141, 71, 141),
        (156, 141, 198, 141),
        (56, 142, 69, 142),
        (158, 142, 197, 142),
        (61, 143, 65, 143),
        (159, 143, 195, 143),
        (161, 144, 193, 144),
        (164, 145, 191, 145),
        (166, 146, 189, 146),
        (169, 147, 186, 147),
        (173, 148, 182, 148)
    ]
    HOME_POSITIONS = [(36, 36), (40, 36), (44, 36), (36, 40), (40, 40)]

    def __init__(self, width, height):
        self.width = width
        self.height = height

    def is_in_home(self, pos):
        return self.HOME_START_POS.x <= pos.x <= self.HOME_END_POS.x and self.HOME_START_POS.y <= pos.y <= self.HOME_END_POS.y

    def is_underwater(self, pos):
        return any(
            start_x <= int(pos.x) <= end_x and start_y <= int(pos.y) <= end_y
            for start_x, start_y, end_x, end_y in self.UNDERWATER_AREAS
        )

    def get_tile_color(self, x, y):
        if 0 <= x <= self.width and 0 <= y <= self.height:
            pyxel.blt(0, 0, 0, x, y, 1, 1, 0)
            return pyxel.pget(0, 0)
        else:
            return 3
